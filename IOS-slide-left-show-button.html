<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" />
	<title>仿IOS-左滑展示按钮</title>
	<style type="text/css">
		* {
			margin:0;
			box-sizing: border-box;
		}
		.list {
			list-style: none;
			-webkit-padding-start: 0;
		}
		.item {
			position: relative;
		}
		.item .content {
			position: relative;
			border-bottom: 1px solid #eee;
			background: #fff;
			padding: 5px 13px;
			width: 100%;
		}
		.content.animate {
			transition: margin-left 300ms;
		}
		.tool {
			position: absolute;
			right: 0;
			top: 0;
			background: #fff;
		}
		.btn {
			height: 100%;
			background: red;
			border: none;
			outline: none;
			padding: 5px 13px;
			text-align: center;
			color: #fff;
		}

		.show {
		    width: 100%;
		    display: block;
		}
	</style>
</head>
<body>
	<ul class="list">
		<li class="item">
			<div class="tool"><button class="btn">操作</button></div>
			<div class="content"><a class="show">列表项</a></div>
		</li>
		<li class="item">
			<div class="tool"><button class="btn">操作</button></div>
			<div class="content"><a class="show">列表项</a></div>
		</li>
		<li class="item">
			<div class="tool"><button class="btn">操作</button></div>
			<div class="content"><a class="show">列表项</a></div>
		</li>
	</ul>

	<script type="text/javascript" src="./lib/zepto/1.2.0/zepto.js"></script>
<!-- 	<script type="text/javascript">
		var _startX;		
		var _touch;
		var _slideWidth;
		var _threshold = 20;
		var _absoluteX;
		var $slider;

		$('.list').on('click','.show',function(e) {
			console.log('show');
		});


		$('.list').on('touchstart','.item',function (e) {
			_touch = e.touches[0];
			_startX = _touch.pageX;
			_slideWidth = $(e.currentTarget).find('.tool').css('width').replace('px','');
			$slider = $(e.currentTarget).find('.content');

			reset();
		});
		$('.list').on('touchmove','.item',function (e) {
			var _deltaX;
			var _currentX;

			_touch = e.touches[0];
			var 
			_currentX = _touch.pageX;
			_deltaX = _currentX - _startX;
			_absoluteX = Math.abs(_deltaX);
			if (_deltaX > 0) return;
			if (_absoluteX > _slideWidth) return;
			$slider.css('margin-left',_deltaX+'px');
		});
		$('.list').on('touchend','.item',function(e){
			$slider.addClass('animate');
			if (_absoluteX < _threshold) {
				$slider.css('margin-left','0');
			} else {
				$slider.css('margin-left','-' + _slideWidth + 'px' ).addClass('unfold');
				$slider[0].addEventListener('click',stopPropagation,true);
			}

			$slider.on('webkitTransitionEnd mozTransitionEnd transitionend',function(e) {
				$(this).removeClass('animate');
			});
			_absoluteX = 0;
			_slideWidth = 0;
			_startX = 0;
			_touch = null;
		});

		$('.list').on('webkitTransitionEnd mozTransitionEnd transitionend','.unfold',function(e) {
			var $el = $(e.currentTarget);

			if ($el.css('margin-left').replace('px','') === '0') {
				$el[0] && $el[0].removeEventListener('click',stopPropagation,true);

				$el.removeClass('unfold');
			};				
		});


		function stopPropagation(e) {
			e.stopPropagation();
			return false;
		}
		function reset() {
			var $unfold = $('.list .item .unfold');
			$unfold.addClass('animate').css('margin-left','0');			
		}
	</script> -->

	<script type="text/javascript">
;(function($){

	$.fn.drawerList = function(options) {
		return new MyDrawer(this,options);
	}

	var MyDrawer = function($el,options) {
		this.$el = $el;
		this.init();
	}

	MyDrawer.prototype.init = function() {
		var me = this;
		var $el = this.$el;
		var _startX;		
		var _touch;
		var _slideWidth;
		var _threshold = 20;
		var _absoluteX;
		var $slider;

		$el.on('click','.show',function(e) {
			console.log('show');
		});			

		$el.on('touchstart','.item',function (e) {
			_touch = e.touches[0];
			_startX = _touch.pageX;
			_slideWidth = $(e.currentTarget).find('.tool').css('width').replace('px','');
			$slider = $(e.currentTarget).find('.content');

			me.reset();
		});
		$el.on('touchmove','.item',function (e) {
			var _deltaX;
			var _currentX;

			_touch = e.touches[0];
			var 
			_currentX = _touch.pageX;
			_deltaX = _currentX - _startX;
			_absoluteX = Math.abs(_deltaX);
			if (_deltaX > 0) return;
			if (_absoluteX > _slideWidth) return;
			$slider.css('margin-left',_deltaX+'px');
		});
		$el.on('touchend','.item',function(e){
			$slider.addClass('animate');
			if (_absoluteX < _threshold) {
				$slider.css('margin-left','0');
			} else {
				$slider.css('margin-left','-' + _slideWidth + 'px' ).addClass('unfold');
				$slider[0].addEventListener('click',stopPropagation,true);
			}

			$slider.on('webkitTransitionEnd mozTransitionEnd transitionend',function(e) {
				$(this).removeClass('animate');
			});
			_absoluteX = 0;
			_slideWidth = 0;
			_startX = 0;
			_touch = null;
		});

		$el.on('webkitTransitionEnd mozTransitionEnd transitionend','.unfold',function(e) {
			var $el = $(e.currentTarget);

			if ($el.css('margin-left').replace('px','') === '0') {
				$el[0] && $el[0].removeEventListener('click',stopPropagation,true);

				$el.removeClass('unfold');
			};				
		});

		function stopPropagation(e) {
			e.stopPropagation();
			return false;
		}
	}

	MyDrawer.prototype.reset = function() {
		var $unfold = $('.item .unfold', this.$el);
		$unfold.addClass('animate').css('margin-left','0');	
	}
  

})(window.Zepto || window.jQuery);

	$('.list').drawerList();
	</script>
</body>
</html>